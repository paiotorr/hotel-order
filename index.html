<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Rasstall Menu</title>

<style>
/* Disable double-tap zoom */
html, body {
  touch-action: manipulation;
}

body{
  font-family: Arial;
  padding: 28px;
  padding-bottom: 380px;
  background: #f8f8f8;
}

h1{
  text-align: center;
  font-size: 34px;
}

#tableInfo{
  text-align: center;
  font-weight: bold;
  margin-bottom: 28px;
  font-size: 24px;
}

/* MENU */
.menu{
  display: flex;
  gap: 30px;
  justify-content: center;
  flex-wrap: wrap;
}

.item{
  background: #fff;
  border: 2px solid #ddd;
  width: 260px;
  padding: 20px;
  text-align: center;
  border-radius: 20px;
}

.item img{
  width: 100%;
  height: 200px;
  object-fit: cover;
  border-radius: 16px;
}

.item h3{
  font-size: 28px;
  margin: 16px 0 8px;
}

.item p{
  font-size: 24px;
  margin: 0;
}

.add-btn{
  margin-top: 18px;
  width: 100%;
  padding: 20px;
  font-size: 26px;
  font-weight: bold;
  background: #3498db;
  color: #fff;
  border: none;
  border-radius: 16px;
  cursor: pointer;
}

/* FIXED ORDER BOX */
#orderBox{
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: #ffffff;
  border-top: 4px solid #27ae60;
  box-shadow: 0 -6px 16px rgba(0,0,0,0.2);
}

/* üî• INNER SAFE CONTAINER (REAL FIX) */
#orderInner{
  max-width: 720px;        /* controls inward distance */
  margin: 0 auto;         /* centers everything */
  padding: 32px 24px;     /* deep inward padding */
}

/* TITLE */
#orderInner h2{
  font-size: 28px;
  margin-top: 0;
  text-align: center;
}

/* SCROLLABLE ORDER LIST */
#orderList{
  max-height: 180px;
  overflow-y: auto;
  margin-bottom: 24px;
}

/* ORDER ROW */
.order-item{
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 18px 0;
  padding: 16px 20px;
  background: #f9f9f9;
  border-radius: 18px;
}

/* ITEM NAME */
.order-name{
  font-size: 32px;
  font-weight: 800;
}

/* REMOVE BUTTON ‚Äî DEEPLY INWARD */
.remove-btn{
  background: #e74c3c;
  color: #fff;
  border: none;
  width: 64px;
  height: 64px;
  border-radius: 50%;
  font-size: 34px;
  font-weight: bold;
  cursor: pointer;
}

/* SUBMIT BUTTON ‚Äî PERFECT CENTER */
.submit-btn{
  display: block;
  margin: 0 auto;         /* üî• true center */
  width: 80%;
  padding: 26px;
  font-size: 28px;
  font-weight: bold;
  background: #27ae60;
  color: #fff;
  border: none;
  border-radius: 20px;
  cursor: pointer;
}

/* STATUS */
#statusBox{
  margin-top: 18px;
  font-size: 24px;
  text-align: center;
  font-weight: bold;
}
</style>
</head>

<body>

<h1>üçΩ Rasstall Menu</h1>
<p id="tableInfo"></p>

<div class="menu">

  <div class="item">
    <img src="https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg">
    <h3>Pizza</h3>
    <p>‚Çπ199</p>
    <button class="add-btn"
      onclick="addItem('Pizza','https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg')">
      ‚ûï ADD
    </button>
  </div>

  <div class="item">
    <img src="https://images.unsplash.com/photo-1550547660-d9450f859349">
    <h3>Burger</h3>
    <p>‚Çπ99</p>
    <button class="add-btn"
      onclick="addItem('Burger','https://images.unsplash.com/photo-1550547660-d9450f859349')">
      ‚ûï ADD
    </button>
  </div>
  
  <div class="item">
    <img src="https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg">
    <h3>Pizza</h3>
    <p>‚Çπ199</p>
    <button class="add-btn"
      onclick="addItem('Pizza','https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg')">
      ‚ûï ADD
    </button>
  </div>

  <div class="item">
    <img src="https://images.unsplash.com/photo-1550547660-d9450f859349">
    <h3>Burger</h3>
    <p>‚Çπ99</p>
    <button class="add-btn"
      onclick="addItem('Burger','https://images.unsplash.com/photo-1550547660-d9450f859349')">
      ‚ûï ADD
    </button>
  </div>
  
  <div class="item">
    <img src="https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg">
    <h3>Pizza</h3>
    <p>‚Çπ199</p>
    <button class="add-btn"
      onclick="addItem('Pizza','https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg')">
      ‚ûï ADD
    </button>
  </div>

  <div class="item">
    <img src="https://images.unsplash.com/photo-1550547660-d9450f859349">
    <h3>Burger</h3>
    <p>‚Çπ99</p>
    <button class="add-btn"
      onclick="addItem('Burger','https://images.unsplash.com/photo-1550547660-d9450f859349')">
      ‚ûï ADD
    </button>
  </div>
  
  <div class="item">
    <img src="https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg">
    <h3>Pizza</h3>
    <p>‚Çπ199</p>
    <button class="add-btn"
      onclick="addItem('Pizza','https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg')">
      ‚ûï ADD
    </button>
  </div>

  <div class="item">
    <img src="https://images.unsplash.com/photo-1550547660-d9450f859349">
    <h3>Burger</h3>
    <p>‚Çπ99</p>
    <button class="add-btn"
      onclick="addItem('Burger','https://images.unsplash.com/photo-1550547660-d9450f859349')">
      ‚ûï ADD
    </button>
  </div>
  
  <div class="item">
    <img src="https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg">
    <h3>Pizza</h3>
    <p>‚Çπ199</p>
    <button class="add-btn"
      onclick="addItem('Pizza','https://raw.githubusercontent.com/paiotorr/Paiotorr/main/image/Pizza.jpg')">
      ‚ûï ADD
    </button>
  </div>

  <div class="item">
    <img src="https://images.unsplash.com/photo-1550547660-d9450f859349">
    <h3>Burger</h3>
    <p>‚Çπ99</p>
    <button class="add-btn"
      onclick="addItem('Burger','https://images.unsplash.com/photo-1550547660-d9450f859349')">
      ‚ûï ADD
    </button>
  </div>

</div>

<!-- ORDER BOX -->
<div id="orderBox">
  <div id="orderInner">

    <h2>Your Order</h2>

    <div id="orderList"></div>

    <button class="submit-btn" onclick="submitOrder()">
      üõé SUBMIT ORDER
    </button>

    <div id="statusBox"></div>

  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, collection, addDoc, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

/* Disable double-click zoom */
document.addEventListener("dblclick", e => e.preventDefault(), { passive:false });

const firebaseConfig = {
  apiKey: "AIzaSyDSf51jWs3I4AXX0U8M_HxKn4VtRYg72xs",
  authDomain: "hotel-order-7f1f2.firebaseapp.com",
  projectId: "hotel-order-7f1f2"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const orderList = document.getElementById("orderList");
const statusBox = document.getElementById("statusBox");
const tableInfo = document.getElementById("tableInfo");

const params = new URLSearchParams(location.search);
const table = params.get("table") || "Unknown";
tableInfo.innerText = "Table: " + table;

/* ORDER WITH QUANTITY */
let order = {};

window.addItem = (name, img) => {
  order[name] ? order[name].qty++ : order[name] = { name, img, qty: 1 };
  render();
};

window.removeItem = (name) => {
  if(order[name]){
    order[name].qty--;
    if(order[name].qty <= 0) delete order[name];
  }
  render();
};

function render(){
  orderList.innerHTML = "";
  Object.values(order).forEach(o=>{
    orderList.innerHTML += `
      <div class="order-item">
        <span class="order-name">${o.name} √ó ${o.qty}</span>
        <button class="remove-btn" onclick="removeItem('${o.name}')">‚úñ</button>
      </div>`;
  });
}

window.submitOrder = async () => {
  if(Object.keys(order).length === 0){
    alert("No items selected");
    return;
  }

  statusBox.innerText = "‚è≥ Waiting for confirmation...";

  const ref = await addDoc(collection(db,"orders"),{
    table,
    items: Object.values(order),
    status: "pending",
    time: new Date().toLocaleString()
  });

  onSnapshot(doc(db,"orders",ref.id),(snap)=>{
    if(!snap.exists()) return;
    const s = snap.data().status;
    if(s === "accepted"){ statusBox.innerText="‚úÖ Order Accepted"; reset(); }
    if(s === "rejected"){ statusBox.innerText="‚ùå Order Rejected"; reset(); }
  });

  order = {};
  render();
};

function reset(){
  setTimeout(()=>{
    statusBox.innerText = "";
    order = {};
    render();
  },2000);
}
</script>

</body>
</html>